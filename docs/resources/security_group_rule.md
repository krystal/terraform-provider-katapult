---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "katapult_security_group_rule Resource - terraform-provider-katapult"
subcategory: ""
description: |-
  Allows management of individual security group rules. This should only be used with the katapult_security_group resource if the external_rules attribute is enabled. Otherwise you should define rules directly on the security group resource.
---

# katapult_security_group_rule (Resource)

Allows management of individual security group rules. This should only be used with the `katapult_security_group` resource if the `external_rules` attribute is enabled. Otherwise you should define rules directly on the security group resource.

## Example Usage

```terraform
# Security Group to create rules in.
resource "katapult_security_group" "web" {
  name = "web"

  # Prevent the security group resource itself to manage rules.
  external_rules = true
}

# Minimal - Allows no traffic as there are no targets.
resource "katapult_security_group_rule" "minimal" {
  security_group_id = katapult_security_group.web.id
  direction         = "inbound"
  protocol          = "tcp"
  targets           = []
}

# Allow incoming HTTP/HTTPS traffic from anywhere
resource "katapult_security_group_rule" "http" {
  security_group_id = katapult_security_group.web.id
  direction         = "inbound"
  protocol          = "tcp"
  ports             = "80,433"
  notes             = "Allow HTTP/HTTPS"
  targets = [
    "all:ipv4", # Allow any IPv4 address.
    "all:ipv6", # Allow any IPv6 address.
  ]
}

# Allow incoming SSH traffic from a specific IP and all virtual
# machines # in the "jumpbox" virtual machine group.
resource "katapult_virtual_machine_group" "jumpbox" {
  name = "jumpbox"
}

resource "katapult_security_group_rule" "ssh" {
  security_group_id = katapult_security_group.web.id
  direction         = "inbound"
  protocol          = "tcp"
  ports             = "22"
  notes             = "Allow SSH"
  targets = [
    "106.240.71.168",
    katapult_virtual_machine_group.jumpbox.id,
  ]
}

# Allow a range of ports from a CIDR block.
resource "katapult_security_group_rule" "range" {
  security_group_id = katapult_security_group.web.id
  direction         = "inbound"
  protocol          = "tcp"
  ports             = "3000-3999"
  notes             = "Allow custom range"
  targets           = ["152.15.204.0/24"]
}

# Allow all ports from a CIDR block.
resource "katapult_security_group_rule" "range_all_ports" {
  security_group_id = katapult_security_group.web.id
  direction         = "inbound"
  protocol          = "tcp"
  notes             = "Allow custom range"
  targets           = ["100.68.232.0/24"]
}

# Allow outgoing SMTP traffic to a specific IP.
resource "katapult_security_group_rule" "smtp" {
  security_group_id = katapult_security_group.web.id
  direction         = "outbound"
  protocol          = "tcp"
  ports             = "25"
  notes             = "Allow SMTP"
  targets           = ["195.66.84.24"]
}

# Allow outgoing HTTP and HTTPS traffic to anywhere.
resource "katapult_security_group_rule" "http_out" {
  security_group_id = katapult_security_group.web.id
  direction         = "outbound"
  protocol          = "tcp"
  ports             = "80,433"
  notes             = "Allow HTTP/HTTPS"
  targets           = ["all:ipv4", "all:ipv6"]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `direction` (String) The direction of the rule (`inbound` or `outbound`).
- `protocol` (String) The protocol of the rule (`TCP`, `UDP`, or `ICMP`).
- `security_group_id` (String) The ID of the security group to which the rule applies.
- `targets` (Set of String) The targets to which the rule applies. Can be IP addresses, CIDR blocks, IDs for virtual machines, virtual machine groups, tags, address lists, or `all:ipv4` and `all:ipv6`.

### Optional

- `notes` (String) Notes for the rule. Used for human reference only.
- `ports` (String) The port, ports, or range of ports to which the rule applies (e.g. `22`, `22,80,443`, or `3000-3999`). If not specified, the rule applies to all ports.

### Read-Only

- `id` (String) The ID of the security group rule. This is automatically generated by the API.


